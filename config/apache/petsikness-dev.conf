<VirtualHost *:80>
    ServerName petsiknessdev.sikwow.com
    ServerAdmin admin@sikwow.com

    # Logs
    ErrorLog /opt/petsikness/logs/apache-dev-error.log
    CustomLog /opt/petsikness/logs/apache-dev-access.log combined

    # Proxy a Next.js desarrollo (puerto 3002)
    ProxyPreserveHost On
    ProxyPass / http://localhost:3002/
    ProxyPassReverse / http://localhost:3002/

    # WebSocket support (cr√≠tico para next dev hot reload)
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/?(.*) "ws://localhost:3002/$1" [P,L]

    # Headers menos restrictivos en dev
    Header always set X-Frame-Options "SAMEORIGIN"

    # Redirigir a HTTPS
    RewriteCond %{SERVER_NAME} =petsiknessdev.sikwow.com
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
